---
import Layout from "../layouts/Layout.astro";
import AboutMe from "../components/aboutme.astro";
import Experience from "../components/experience.astro";
import Projects from "../components/projects.astro";
import Globe from "../assets/globe.svg";
---

<script>
  const gradient = document.querySelector("#emeraldGradient");
  if (gradient) {
    gradient.style.opacity = "0";
  }

  document.addEventListener("mousemove", (e) => {
    const gradient = document.querySelector("#emeraldGradient");
    if (gradient) {
      const rect = gradient.closest("svg").getBoundingClientRect();
      const x = ((e.clientX - rect.left) / rect.width) * 100;
      const y = ((e.clientY - rect.top) / rect.height) * 100;
      gradient.setAttribute("cx", `${x}%`);
      gradient.setAttribute("cy", `${y}%`);
    }
  });
</script>

<Layout>
  <div
    class="flex flex-col md:flex-row md:w-2/3 w-full mx-auto justify-between relative"
  >
    <aside class="md:w-1/3">
      <div class="flex flex-col mt-36 gap-16 items-center sticky top-36">
        <div>
          <div>
            <p class="ml-2 mt-2 text-md text-[#B1A7A6]">
              〞Developing user centered software with a social impact〟
            </p>
            <h1 class="text-6xl mt-8 font-bold font-anton text-[#E5383B]">
              Daan Gunnink
            </h1>

            <h2 class="mt-2 text-2xl font-bold text-[#B1A7A6]">
              Team Lead and Software Engineer
            </h2>
            <h2 class="text-lg text-[#B1A7A6]">at Infowijs</h2>
          </div>
        </div>
      </div>
    </aside>

    <main class="flex flex-col md:w-1/2 relative">
      <div class="flex flex-row justify-end items-center sticky top-16 right-0">
        <a href="#aboutme" id="aboutme-a" class="text-xs text-[#F5F3F4]/40"
          >About me</a
        >
        <span class="text-xs text-[#F5F3F4]/70 mx-2"> / </span>
        <a
          href="#experience"
          id="experience-a"
          class="text-xs text-[#F5F3F4]/40">Experience</a
        >
        <span class="text-xs text-[#F5F3F4]/70 mx-2"> / </span>
        <a
          href="#projects"
          id="projects-a"
          class="text-2xl font-bold text-end text-[#F5F3F4]">Projects</a
        >
      </div>
      <section class="snap-start mb-[100vh] pb-16 pt-20" id="aboutme">
        <AboutMe />
      </section>
      <section class="snap-start mb-[100vh] pb-16 pt-20" id="experience">
        <Experience />
      </section>
      <section class="snap-start min-h-screen pt-20" id="projects">
        <Projects />
      </section>
    </main>
  </div>
</Layout>

<script>
  const sections = document.querySelectorAll("section");
  const navLinks = [
    document.getElementById("aboutme-a"),
    document.getElementById("experience-a"),
    document.getElementById("projects-a"),
  ];

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const currentSection = entry.target.id;

          for (const link of navLinks) {
            if (!link) continue;
            if (link.id === currentSection + "-a") {
              link.className =
                "text-2xl font-bold text-end text-[#F5F3F4] transition-colors";
            } else {
              link.className =
                "text-xs text-[#F5F3F4]/40 transition-colors hover:text-[#E5383B]";
            }
          }
        }
      });
    },
    {
      threshold: 0.5, // Trigger when 50% of the section is visible
    }
  );

  sections.forEach((section) => {
    observer.observe(section);
  });
</script>
